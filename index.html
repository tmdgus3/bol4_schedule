<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>볼빨간사춘기 스케줄</title>
  <link rel="stylesheet" href="https://uicdn.toast.com/calendar/latest/toastui-calendar.min.css" />
  <style>
    body {
      margin: 0;
      padding: 5px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      -webkit-text-size-adjust: 100%;
    }
    #calendar-controls {
      display: flex; align-items: center; justify-content: center; margin-bottom: 8px;
    }
    #calendar-controls button {
      border: 1px solid #ddd; background-color: #fff; padding: 6px 10px; border-radius: 4px;
      cursor: pointer; margin: 0 4px; font-size: 14px;
    }
    #calendar-controls button:hover { background-color: #f5f5f5; }
    #month-year { font-size: 18px; font-weight: bold; margin: 0 10px; text-align: center; white-space: nowrap; }
    #calendar { height: 85vh; }

    /* ✅ 월뷰에서 시간 라벨 전부 숨김 (00:00 등) */
    .toastui-calendar-event-time,
    .toastui-calendar-weekday-event-time,
    .toastui-calendar-month-allday-event-time {
      display: none !important;
    }

    /* 팝업은 그대로 보이게 (숨기지 않음) */
    /* .toastui-calendar-popup-section-item[...] 제거함 */
    
    /* 인덱스(범례) */
    #calendar-index {
      display: flex; justify-content: center; flex-wrap: wrap; padding: 10px 0; gap: 12px 16px;
    }
    .index-item { display: flex; align-items: center; font-size: 13px; }
    .index-color-chip { width: 14px; height: 14px; border-radius: 4px; margin-right: 6px; }
  </style>
</head>
<body>
  <div id="calendar-controls">
    <button id="prev-btn">이전달</button>
    <h1 id="month-year"></h1>
    <button id="next-btn">다음달</button>
    <button id="today-btn" style="margin-left: 10px;">오늘</button>
  </div>

  <div id="calendar"></div>

  <!-- ✅ 인덱스(범례) 유지 -->
  <div id="calendar-index">
    <div class="index-item"><span class="index-color-chip" style="background-color: #E61E2A;"></span>콘서트</div>
    <div class="index-item"><span class="index-color-chip" style="background-color: #449D44;"></span>페스티벌</div>
    <div class="index-item"><span class="index-color-chip" style="background-color: #31708F;"></span>대학축제</div>
    <div class="index-item"><span class="index-color-chip" style="background-color: #F0AD4E;"></span>기타 행사</div>
    <div class="index-item"><span class="index-color-chip" style="background-color: #00FFFF;"></span>온라인 방송</div>
    <div class="index-item"><span class="index-color-chip" style="background-color: #FF00FF;"></span>비공식 이벤트</div>
  </div>

  <script src="https://uicdn.toast.com/calendar/latest/toastui-calendar.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const Calendar = tui.Calendar;
      const container = document.getElementById('calendar');

      /* 카테고리 색상 (인덱스와 동일) */
      const calendarColors = {
        '콘서트':        { backgroundColor: '#E61E2A', borderColor: '#E61E2A', color: '#ffffff', bgColor: '#E61E2A' },
        '페스티벌':      { backgroundColor: '#449D44', borderColor: '#449D44', color: '#ffffff', bgColor: '#449D44' },
        '대학축제':      { backgroundColor: '#31708F', borderColor: '#31708F', color: '#ffffff', bgColor: '#31708F' },
        '기타 행사':     { backgroundColor: '#F0AD4E', borderColor: '#F0AD4E', color: '#000000', bgColor: '#F0AD4E' },
        '온라인 방송':   { backgroundColor: '#00FFFF', borderColor: '#00FFFF', color: '#000000', bgColor: '#00FFFF' },
        '비공식 이벤트': { backgroundColor: '#FF00FF', borderColor: '#FF00FF', color: '#ffffff', bgColor: '#FF00FF' }
      };

      const calendars = Object.keys(calendarColors).map((k) => ({
        id: k, name: k, ...calendarColors[k]
      }));

      const calendar = new Calendar(container, {
        defaultView: 'month',
        isReadOnly: true,
        useDetailPopup: true,       // 클릭 시 팝업 열림
        month: {
          dayNames: ['일', '월', '화', '수', '목', '금', '토'],
          visibleEventCount: 2
        },
        timezone: { zones: [{ timezoneName: 'Asia/Seoul' }] },
        calendars,
        template: {
          /* ✅ 월뷰: 제목만 렌더링 */
          month: {
            schedule(event) { return `<span>${event.title}</span>`; }
          },
          /* 하루종일도 제목만 */
          allday(event) { return `<span>${event.title}</span>`; }
        }
      });

      /* 원본 스케줄 */
      const rawSchedules = [
        { id: '1',  calendarId: '온라인 방송',  title: '아는 형님',        start: '2025-08-02T21:00:00', end: '2025-08-02T22:30:00', body: 'JTBC' },
        { id: '2',  calendarId: '페스티벌',    title: '대전 영시축제',    start: '2025-08-10T21:30:00', end: '2025-08-10T22:30:00', location: '대전 중앙로역 특설무대' },
        { id: '3',  calendarId: '기타 행사',      title: '청소년 콘캉스',    start: '2025-08-12T17:30:00', end: '2025-08-12T18:30:00', location: '문경문화예술회관' },
        { id: '4',  calendarId: '기타 행사',   title: '삼성 라이온즈 시구', start: '2025-08-14T18:30:00', end: '2025-08-14T19:00:00', location: '대구 삼성 라이온즈 파크' },
        { id: '8',  calendarId: '기타 행사',    title: 'EBS 스페이스 공감', start: '2025-08-31T16:00:00', end: '2025-08-31T17:00:00', location: '노들갤러리 2관 (서울 용산구 양녕로 445)' },
        { id: '6',  calendarId: '비공식/이벤트', title: '생일 카페',       start: '2025-09-13', end: '2025-09-14', isAllday: true, location: '홍대 러비니돌 카페' },
        { id: '5',  calendarId: '페스티벌',    title: '사운드 플래닛',    start: '2025-09-14T19:50:00', end: '2025-09-14T20:50:00', location: '인천 파라다이스 시티' },
        { id: '9',  calendarId: '대학축제',    title: '성신여대 축제',    start: '2025-09-18', end: '2025-09-19', isAllday: true, body: '9월 18일 또는 19일 출연 예정', location: '성신여자대학교 돈암수정캠퍼스' },
        { id: '10', calendarId: '대학축제',    title: '가톨릭상지대 축제', start: '2025-09-25', end: '2025-09-25', isAllday: true, location: '가톨릭상지대학교 운동장 야외 특설무대' },
        { id: '7',  calendarId: '페스티벌',    title: 'MADLY MEDLEY',    start: '2025-10-19', end: '2025-10-19', isAllday: true, location: '파라다이스시티' }
      ];

      /* ✅ 색상 강제 주입(기본 연두색 대신 카테고리 색 적용) */
      const schedules = rawSchedules.map(ev => ({
        ...ev,
        ...calendarColors[ev.calendarId]  // backgroundColor/borderColor/color/bgColor 주입
      }));
      calendar.createEvents(schedules);

      // 네비게이션
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const todayBtn = document.getElementById('today-btn');
      const monthYearEl = document.getElementById('month-year');

      function updateMonthYear() {
        const currentDate = calendar.getDate();
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth() + 1;
        monthYearEl.textContent = `${year}년 ${month}월`;
      }

      prevBtn.addEventListener('click', () => { calendar.prev(); updateMonthYear(); });
      nextBtn.addEventListener('click', () => { calendar.next(); updateMonthYear(); });
      todayBtn.addEventListener('click', () => { calendar.today(); updateMonthYear(); });

      updateMonthYear();
    });
  </script>
</body>
</html>
